"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.streamLines = void 0;
const index_1 = require("./index");
const readableAsyncIterator_1 = require("./readableAsyncIterator");
function stringSplitter(encoding) {
    return {
        initial() {
            return "";
        },
        split(chunk, previous) {
            var _a;
            const lines = chunk.toString(encoding).split("\n");
            lines[0] = previous + lines[0];
            let remainder = (_a = lines.pop()) !== null && _a !== void 0 ? _a : "";
            return [lines, remainder];
        },
        last(remainder) {
            return remainder != "" ? remainder : null;
        }
    };
}
function streamLines(readable, encoding) {
    return index_1.asyncStream(readableAsyncIterator_1.readableAsyncIterator(readable, stringSplitter(encoding)));
}
exports.streamLines = streamLines;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGluZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzcmMvbGluZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EsbUNBQW1EO0FBQ25ELG1FQUEwRTtBQUUxRSxTQUFTLGNBQWMsQ0FBQyxRQUF5QjtJQUMvQyxPQUFPO1FBQ0wsT0FBTztZQUNMLE9BQU8sRUFBRSxDQUFDO1FBQ1osQ0FBQztRQUVELEtBQUssQ0FBQyxLQUFhLEVBQUUsUUFBZ0I7O1lBQ25DLE1BQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRW5ELEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxRQUFRLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQy9CLElBQUksU0FBUyxHQUFHLE1BQUEsS0FBSyxDQUFDLEdBQUcsRUFBRSxtQ0FBSSxFQUFFLENBQUM7WUFFbEMsT0FBTyxDQUFDLEtBQUssRUFBRSxTQUFTLENBQUMsQ0FBQztRQUM1QixDQUFDO1FBRUQsSUFBSSxDQUFDLFNBQWlCO1lBQ3BCLE9BQU8sU0FBUyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7UUFDNUMsQ0FBQztLQUNGLENBQUM7QUFDSixDQUFDO0FBRUQsU0FBZ0IsV0FBVyxDQUN6QixRQUFrQixFQUNsQixRQUF5QjtJQUV6QixPQUFPLG1CQUFXLENBQUMsNkNBQXFCLENBQUMsUUFBUSxFQUFFLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDaEYsQ0FBQztBQUxELGtDQUtDIn0=